selected: true
year: 2021
last_updated: 4-10-2021
authors: Perez-Nieves N, Leung VCH, Dragotti PL, Goodman DFM
title: Neural heterogeneity promotes robust learning
journal: Nature Communications
additional: 12, 5791
doi: 10.1038/s41467-021-26022-3
categories:
- Neuroscience
- Learning
- Visual
- Auditory
- Spiking
- Machine learning
- Modelling
urls:
- - Journal (HTML)
  - https://www.nature.com/articles/s41467-021-26022-3
- - Journal (PDF)
  - https://www.nature.com/articles/s41467-021-26022-3.pdf
- - Preprint
  - https://www.biorxiv.org/content/10.1101/2020.12.18.423468v3
- - Code (GitHub)
  - https://github.com/npvoid/neural_heterogeneity
- - Code (Zenodo)
  - https://zenodo.org/record/5413181
- - Neurotheory talk by Dan Goodman (video)
  - https://www.youtube.com/watch?v=V2HFqVfeTPg&feature=youtu.be
- - SNUFA 2021 talk by Nicolas Perez (video)
  - https://youtu.be/aLNGcs_zYsY
- - Podcast with WaterCooler Neuroscience
  - https://open.spotify.com/episode/6PYxjRFg2bI8pSDN82Dume?si=S7Z4BxXNS2aRCnbBMskTHg
abstract: The brain is a hugely diverse, heterogeneous structure. Whether or not heterogeneity
  at the neural level plays a functional role remains unclear, and has been relatively
  little explored in models which are often highly homogeneous. We compared the performance
  of spiking neural networks trained to carry out tasks of real-world difficulty,
  with varying degrees of heterogeneity, and found that heterogeneity substantially
  improved task performance. Learning with heterogeneity was more stable and robust,
  particularly for tasks with a rich temporal structure. In addition, the distribution
  of neuronal parameters in the trained networks is similar to those observed experimentally.
  We suggest that the heterogeneity observed in the brain may be more than just the
  byproduct of noisy processes, but rather may serve an active and important role
  in allowing animals to learn in changing environments.
video_embed: <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/aLNGcs_zYsY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
explainer_html: >
  Have you ever wondered why neurons are like snowflakes? No two alike, even if they're the same type. In our latest preprint, we think we have (at least part of) the answer: it promotes robust learning.
  <img src="https://pbs.twimg.com/media/EpwgTeQWwAAOqgN?format=jpg&name=small"/>
  <p>
  One of the striking things about the brain is how much diversity there is at so many levels, e.g. the distribution of membrane time constants. Check these out from the Allen Institute
  and Paul Manis - there's a wide range of values for single cell types, a bit like a log normal distribution.
  <img src="https://pbs.twimg.com/media/EpwiOS2WwAEbp-a?format=jpg&name=small"/>
  <p>
  But, most models of networks of neurons that can carry out complex information processing tasks tend to use the same parameters for all neurons of the same type, with typically only connectivity being different for each neuron.
  <p>
  We guessed that networks of neurons with a wide range of time constants would be better at tasks where information is present at multiple time scales, such as auditory tasks like recognising speech.
  <p>
  Since we were interested in temporal dynamics and comparing to biology, we used spiking neural networks trained using <a href="https://github.com/fzenke/spytorch">surrogate gradient descent</a>, adapted to learn time constants as well as weights.
  <p>
  We found no improvement for N-MNIST which has little to no useful temporal information in the stimuli, some improvement for DVS gestures which does have temporal info but can be solved well without using it, and a huge improvement for recognising spoken digits.
  <img src="https://pbs.twimg.com/media/EpwoXCUWwAAFjPn?format=jpg&name=small"/>
  <p>
  The distributions of time constants learned are consistent for a given task, for each run, and regardless of whether you initialise time constants randomly or at a fixed value. And, they look like the distributions you find in the brain.
  <img src="https://pbs.twimg.com/media/Epwp1TgWMAAaNEo?format=jpg&name=small"/>
  <p>
  And it's more robust. If you tune hyperparameters for sounds at a single speed, and then change the playback speed of stimuli, the heterogeneous networks can still learn the task but homogeneous ones start to fall down.
  <img src="https://pbs.twimg.com/media/Epwz4SiXcAENGkL?format=jpg&name=small"/>
  <p>
  We also tested another training method, spiking FORCE <a href="https://doi.org/10.1038/s41467-017-01827-3">(Nicola and Clopath 2017)</a>, and found the same robustness to hyperparameter mistuning. This figure shows the region where learning converges to a good solution in blue, axes are hyperparameters.
  <img src="https://pbs.twimg.com/media/Epw1yK9XIAYEJRt?format=jpg&name=small"/>
  <p>
  So this looks to be pretty general: heterogeneity improves learning of temporal tasks and gives robustness against hyperparameter mistuning. And it does so at no metabolic cost. The same performance with homogeneous networks requires 10x more neurons! So, surely the brain uses this?
  <p>
  This is also good for neuromorphic computing and ML: adding neuron level heterogeneity costs only O(n) time and memory, whereas adding more neurons and synapses costs O(nÂ²).
  <p>
  That's it for the results, we hope that this spurs people to look further into the importance of heterogeneity, e.g. spatial or cell type heterogeneity, and whether it can be useful in ML too.
  <p>
  If you're interested in this area, there's a fascinating literature on heterogeneity, briefly reviewed in this paper, including similar work with a more neuromorphic angle from Sander Bohte and Tim Masquelier. There's a nice review in <a href="https://doi.org/10.1016/j.conb.2015.12.008">Gjorgjieva et al. (2016)</a>.
  <p>
  This work was only possible thanks to two incredible scientific developments. The first is new methods of training spiking neural networks from Friedemann Zenke and others. We had a workshop on this over the summer, videos available at the <a href="https://www.youtube.com/playlist?list=PL09WqqDbQWHFvM9DFYkM_GfnrVnIdLRhy">SNUFA 2020 playlist</a>.
  <p>
  The second is the availability of incredible experimental datasets thanks to orgs like the Allen Institute, the <a href="https://neuroelectro.org">NeuroElectro Database</a> and individual labs like Paul Manis'. Thank you so much for your generosity!